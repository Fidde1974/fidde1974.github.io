<HTML>

<script>

var infoMap = new Map();
async function getSorter() {
response =  await fetch("sorter/sorter.json");
sorter = await response.json();

for(let part of sorter) {
	response =  await fetch("sorter/"+part+"/info.json");
	info = await response.json()
	info.url = await getShortcut(part);
	infoMap.set(part, info);
}

}


async function getShortcutFile(sort) {
response =  await fetch("sorter/"+sort+"/url.url");
return  await response.text();
}

function getShortcut(sort){
	return getShortcutFile(sort).then(y => {
		var arrLines = y.split("URL=");
		return arrLines[1].split("\n")[0];
		});
}


async function printTiles(){
	getSorter().then(() => {
	console.log(infoMap.keys());
	
	infoMap.forEach((value, key) => {
		console.log(key);
		console.log(value);
		document.body.innerHTML +="<img src=\"sorter/"+key+"/bild.jpg\">"+ key +value.namn+ "<a href=\""+value.url+"\" target=\"_new\">Link</a> <br>";
		//getShortcut(val).then(x => console.log(x))
	});
	});

	
}


printTiles();

</script>
<body>
test
</body>
<//HTML>