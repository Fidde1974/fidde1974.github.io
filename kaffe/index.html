<HTML>

<script>

var infoMap = new Map();
async function getSorter() {
response =  await fetch("sorter/sorter.json");
sorter = await response.json();

for(let part of sorter) {
	response =  await fetch("sorter/"+part+"/info.json");
	info = await response.json()
	info.url = await getShortcut(part);
	infoMap.set(part, info);
}

}


async function getShortcutFile(sort) {
response =  await fetch("sorter/"+sort+"/url.url");
return  await response.text();
}

function getShortcut(sort){
	return getShortcutFile(sort).then(y => {
		var arrLines = y.split("URL=");
		return arrLines[1].split("\n")[0];
		});
}


async function printTiles(){
	getSorter().then(() => {
	console.log(infoMap.keys());
	
	infoMap.forEach((value, key) => {
		console.log(key);
		console.log(value);
		//document.body.innerHTML +="<img src=\"sorter/"+key+"/bild.jpg\">"+ key +value.namn+ "<a href=\""+value.url+"\" target=\"_new\">Link</a> <br>";
		//getShortcut(val).then(x => console.log(x))
		document.getElementById('panel').appendChild(createTile(key,  value));
	});
	});

	
}

function createTile(key, value){
	var iDiv = document.createElement('div');
	iDiv.className = 'block';
	var img = document.createElement('img');
    img.src = 'sorter/'+key+'/bild.jpg';
	img.className = 'thumb';
	
	iDiv.appendChild(img);
	var innerDiv = document.createElement('div');
	innerDiv.className = 'block2';
	innerDiv.innerHTML  = value.namn;
	iDiv.appendChild(innerDiv);

	
	return iDiv;
}

printTiles();

</script>

<style>
body {
	background-color:#664240;
}
div.top {
	background-color:#664240;
	width:100%;
}
div.panel {
	background-color:#664240;
	width:100%;
}
div.block{
	border-style: solid;
	border-color: black;
	margin-bottom:4px;
	padding:2px;
}
div.block2{
	float: right;
	width:74%;
	border-style: solid;
	border-color: red;
}
h1{
	font:normal 6vw arial
}

img.thumb{
	width:25%
}
</style>
<body>
<div class="top">
<h1>Kaffe vi testat<h1>
</div>
<div id="panel" class="panel">

</div>
</body>
<//HTML>